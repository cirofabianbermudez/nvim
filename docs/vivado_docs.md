# Vivado notes

## Install on Pop! OS

Download `FPGAs_AdaptiveSoCs_Unified_2024.2_1113_1001_Lin64.bin`

Run the following commands:

```bash
sudo apt-get install libtinfo5
sudo apt install libncurses5
chmod +x FPGAs_AdaptiveSoCs_Unified_2024.2_1113_1001_Lin64.bin
sudo ./FPGAs_AdaptiveSoCs_Unified_2024.2_1113_1001_Lin64.bin
```

Select the free version of Vivado and leave everything as default.
You can uncheck some options to save some space but for simplicity
leave as it is.

Add to your `~/.bashrc` the following:

```bash
# Vivado
source /tools/Xilinx/Vivado/2024.2/settings64.sh
```

be aware of the version you are installing.

Install the cable drivers

```bash
sudo chmod +x /tools/Xilinx/Vivado/2024.2/data/xicom/cable_drivers/lin64/install_script/install_drivers/install_drivers
sudo ./tools/Xilinx/Vivado/2024.2/data/xicom/cable_drivers/lin64/install_script/install_drivers/install_drivers
```

Check your OS with `cat /etc/os-release`, I'm using:

```bash
NAME="Pop!_OS"
VERSION="22.04 LTS"
ID=pop
ID_LIKE="ubuntu debian"
PRETTY_NAME="Pop!_OS 22.04 LTS"
VERSION_ID="22.04"
HOME_URL="https://pop.system76.com"
SUPPORT_URL="https://support.system76.com"
BUG_REPORT_URL="https://github.com/pop-os/pop/issues"
PRIVACY_POLICY_URL="https://system76.com/privacy"
VERSION_CODENAME=jammy
UBUNTU_CODENAME=jammy
LOGO=distributor-logo-pop-os
```

Verify that tclsh is found in your system:

```bash
which tclsh
```

In case the Tcl package is not installed on your Linux system, use:

```bash
sudo apt-get install tcl tcllib
```

Sometimes with newer OS some critial header files for the C standard library
are missing. Vivado needs some of this libraries, in particular `bits/libc-header-start.h`,
This is a common issue on Ubuntu-based systems (including Pop!\_OS). To solve this use:

```bash
sudo apt update
sudo apt install gcc-multilib
```

Optionaly if this does not not solve the problem

```bash
sudo apt install libc6-dev-i386
```


## Running the Vivado Simulator in Batch Mode

To run Vivado Simulator in batch mode, the simulator relies on three processes, 
which are supported by the files generated by the `export_simulation` command.

- Parsing Design Files, `xvhdl` and `xvlog`
- Elaborate and Generating a Design Snapshot, `xelab`
- Simulating the Design Snapshot, `xsim`

### Parsing Design Files

Note: Switches with double dash `--` can also be used with a single dash `-`

The `xvlog` command is the Verilog parser. The xvlog command parses the Verilog 
source file(s) and stores the parsed dump into an HDL library on disk.


`xvlog` Syntax

```plain
xvlog 
[-d [define] <name>[=<val>]]
[-encryptdumps]
[-f [-file] <filename>]
[-h [-help]]
[-i [include] <directory_name>]
[-initfile <init_filename>]
[-L [-lib] <library_name> [=<library_dir>]]
[-log <filename>]
[-nolog]
[-noname_unamed_generate]
[-relax]
[-prj <filename>]
[-sourcelibdir <sourcelib_dirname>]
[-sourcelibext <file_extension>]
[-sourcelibfile <filename>]
[-sv]
[-v [verbose] [0|1|2]]
[-version] 
[-work <library_name> [=<library_dir>]
[-incr]
[-nosignalhandlers]
[-uvm_version arg]
```
                                             
| Flag               | Description                                                                                                                                                                                                                                                                                       | 
| ---                | ---                                                                                                                                                                                                                                                                                               | 
| `-sv`              | Compile input files in SystemVerilog mode                                                                                                                                                                                                                                                         | 
| `-i`               | Specify directories to searched for files included unsing Verilog `` `include ``. Use `-i` for each specifies search directory                                                                                                                                                                    | 
| `-relax`               | Relax strict HDL language checking                                                                                                                                                                                                                                                                | 
| `-nolog`           | Suppress log file generation                                                                                                                                                                                                                                                                      | 
| `-log <arg>`       | Specify the log file name. Default is `<application_name>.log`                                                                                                                                                                                                                                    | 
| `-f`               | Read additional options from the specified file                                                                                                                                                                                                                                                   | 
| `-work <arg>`      | Specify the work library. The format of the argument is `<name>[=<dir>]` where `<name>` is the logical name of the library and `<dir>` is an optional physical directory of the library                                                                                                           | 
| `-proj <arg>`      | Specify Vivado Simulator project file containing one or more entries of `vhdlverilog <work_lib> <HDL_file_name>`                                                                                                                                                                                  | 
| `-L <arg>`         | Specify search libraries for the instantiated design units in a Verilog or Mixed language design. Use `-L` for each search library. The format of the argument is `<name>[=<dir>]` where `<name>` is the logical name of the library and `<dir>` is an optional physical directory of the library | 
| `-d <arg>`         | Define Verilog macros. Use `-d` for each Verilog macro. The format of the macro is `<name>[=<val>]` where `<name>` is name of the macro and `<value>` is an optional value of the macro |

`xelab` Syntax

```plain
xelab 
[-d [define] <name>[=<val>]
[-debug <kind>]
[-f [-file] <filename>]
[-generic_top <value>]
[-h [-help]
[-i [include] <directory_name>]
[-initfile <init_filename>]
[-log <filename>]
[-L [-lib] <library_name> [=<library_dir>]
[-maxdesigndepth arg]
[-mindelay]
[-typdelay]
[-maxarraysize arg]
[-maxdelay]
[-mt arg]
[-nolog]
[-noname_unnamed_generate]
[-notimingchecks]
[-nosdfinterconnectdelays]
[-nospecify]
[-O arg]
[-override_timeunit]
[-override_timeprecision]
[-prj <filename>]
[-pulse_e arg]
[-pulse_r arg]
[-pulse_int_e arg]
[-pulse_int_r arg]
[-pulse_e_style arg]
[-r [-run]]
[-R [-runall]]
[-rangecheck]
[-relax]
[-s [-snapshot] arg]
[-sdfnowarn]
[-sdfnoerror]
[-sdfroot <root_path>]
[-sdfmin arg]
[-sdftyp arg]
[-sdfmax arg]
[-sourcelibdir <sourcelib_dirname>]
[-sourcelibext <file_extension>]
[-sourcelibfile <filename>]
[-stats]
[-timescale]
[-timeprecision_vhdl arg]
[-transport_int_delays]
[-v [verbose] [0|1|2]] 
[-version]
[-sv_root arg]
[-sv_lib arg]
[-sv_liblist arg]
[-dpiheader arg]
[-driver_display_limit arg]
[-dpi_absolute]
[-incr]
[-93_mode]
[-nosignalhandlers]
[-dpi_stacksize arg]
[-transform_timing_checkers]
[-a[ --standalone]
[-ignore_assertions]
[-ignore_coverage]
[-cov_db_dir arg]
[-cov_db_name arg]
[-uvm_version arg]
[-report_assertion_pass]
[-dup_entity_as_module]
[-cc_celldefines]
[-cc_libs]
[-cc_type arg]
[-cov_db_dir arg]
[-cov_db_name arg]
[-ignore_localparam_override]
[-sc_lib arg]
[-sc_root arg]
```

`xsim` Syntax

```plain

```


## References

[Vivado Design Suite Guide: Logic Simulation (UG900)](https://docs.amd.com/r/en-US/ug900-vivado-logic-simulation/Overview)

[Vivado Design Suite Tutorial: Logic Simulation (UG937)](https://docs.amd.com/r/en-US/ug937-vivado-design-suite-simulation-tutorial/Vivado-Simulator-Overview)

[UVM Support in Vivado Simulator](https://adaptivesupport.amd.com/s/article/1070861?language=en_US)

[Vivado Design Suite Tcl Command Reference Guide (UG835)](https://docs.amd.com/r/en-US/ug835-vivado-tcl-commands/General-Tcl-Syntax-Guidelines)

[AMD Technical Information Portal](https://docs.amd.com/)
